<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">
<head>
<title>Insert title here</title>
<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=bf5eb602e7479411ca85be04bd126fbb"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
<script type="text/javascript" 
src="//dapi.kakao.com/v2/maps/sdk.js?appkey=d2b656d20ccafdc06e8cff4e6a7e35ef"></script>
  
<style type="text/css">
	
</style>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
	$(function(){
		var user_num = $("#userNum").val(); // 세션에 저장된 user_num 가져오기
		$.ajax({
			url:"/findByUserNum",
			data:{user_num: user_num},
			success:function(list){
				console.log(list);
				for(i=0; i<list.length; i++){
					var option = $("<option></option>");
					$("#planList").append($(option).html(list[i].plan_name));
				} 
			}
		});
		var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
		mapOption = { 
		    center: new kakao.maps.LatLng(37.556317, 126.922713), // 지도의 중심좌표
		    level: 3 // 지도의 확대 레벨
		};

		//지도를 표시할 div와  지도 옵션으로  지도를 생성합니다
		var map = new kakao.maps.Map(mapContainer, mapOption);
		var group_num;
		
 		$("#btnGrpAdd").on("click", function(){
			$("#planList").hide();
			$("#planText").show();
			$(this).hide();
			$("#btnGrpList").show();
			
			//그룹넘버 가져오기!
			$.ajax({
				url:"/getNextGroupNum",
				success:function(data){
					group_num = data;
					console.log(group_num);
				}
			})
		});
 		$("#btnGrpList").on("click", function(){
 			$("#planList").show();
 			$("#planText").hide();
 			$(this).hide();
 			$("#btnGrpAdd").show();
 		});

	});
	
	
</script>
</head>
<body>

	<h2>플랜 입력 양식</h2>
	<hr>
	
	<div class="container border">
		<div class="form-inline">
			<!-- 여행 타이틀 (plan_group_num) -->
			<div class="input-group border">

			<input style="display: none" id="planText" type="text" class="form-control" name="plan_name">
			<select id="planList" class="form-select" aria-label="select-plan-group">
				<option selected>여행 계획 선택</option>
			</select>
			<div class="input-group-addon input-group-button">
				<button type="button" id="btnGrpAdd" class="btn btn-dark">새그룹추가</button>
				<button style="display: none" type="button" id="btnGrpList" class="btn btn-dark">리스트보이기</button>
				<button type="button" id="btnGrpDel" class="btn btn-dark">삭제</button>
			</div>
			</div>
		</div> 
		<!-- 여기까지 여행 타이틀 코드 -->
		<!-- 여기부터 주요 컨텐츠 -->
		<div class="row">
		   <div id="map" class="col border"></div> <!-- 지도 map -->
		   <div class="col border">
		     <form action="/savePlan" method="post">
		     	<div class="row justify-content-center">
		     		<!-- 여행 날짜(plan_date) : <br> -->
		     		<input type="date" name="plan_date" th:value="${plan_date}" class="col-5"><br>
		     	</div>
				<!-- 플랜 그룹 정보 -->
				<div class="border">
					플랜 그룹 넘버(plan_group_num) : <input type="number" name="plan_group_num" th:value="${groupnum}"><br>
					플랜 그룹 이름(plan_name) : <input type="text" name="plan_name" th:value="${plan_name}"><br>
					<hr>
					<input type="hidden" id="userNum" name="userinfo.user_num" th:value="${user.user_num}">
					유저 번호(user_num) : <span th:text="${user.user_num}"></span><br>
					장소 번호(place_num) :
					<select name="place.place_num">
						<option value="">-- 선택 --</option>
						<option th:each="p:${place_list}" th:value="${p.place_num}" th:text="${p.place_name}"></option>
					</select>
					<hr>
					<!-- 여행 세부 내용 -->
					플랜 번호(plan_num) : <input type="number" name="plan_num" th:value="${plannum}"><br>
					플랜 플로우 번호(해당 날짜의 여행 순서; plan_flow_num): <br>
					<input type="number" name="plan_flow_num" th:value="${plan_flow_num}"><br>
					플랜 플로우 이름(해당 장소; plan_flow_name) : <br>
					<input type="text" name="plan_flow_name" th:value="${plan_flow_name}">
					<input type="submit" value="등록" id="btnSubmit">
				</div>
			   <!-- 입력, 수정, 삭제 버튼위치 -->
			 	<div class="d-flex justify-content-end"  aria-label="save, delete button">
				  <button type="button" class=" btn btn-dark">저장</button>
				  <button type="button" class=" btn btn-dark">수정</button>
				  <button type="button" class=" btn btn-dark">삭제</button>
				</div>
			</form>
		   </div>
	 	</div>
	 	
	 	<!-- 여기까지 주요 컨텐츠 -->
	 	
	</div>
	
	<!-- <hr>
		<button id="btnDibs">찜리스트 불러오기</button>
		<button id="btnRsv">예약리스트 불러오기</button> -->
	<hr>
		찜 리스트: 
		<select name="dibs.place_num" >
			<option th:each="d:${dibs}" th:value="${d.place.place_num}" th:text="${d.place.place_name}"></option>
		</select><br>

		<hr>
		
		예약 리스트:
		<select name="reservation.place_num">
			<option th:each="r:${reservation}" th:value="${r.place.place_num}" th:text="${r.place.place_name}"></option>
		</select><br>
	
</body>
</html>

<!-- 

	
 -->